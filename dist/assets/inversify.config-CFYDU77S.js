var sn=Object.defineProperty;var un=(n,t,e)=>t in n?sn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Tt=(n,t,e)=>un(n,typeof t!="symbol"?t+"":t,e);var ee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ne;(function(n){(function(t){var e=typeof globalThis=="object"?globalThis:typeof ee=="object"?ee:typeof self=="object"?self:typeof this=="object"?this:l(),r=i(n);typeof e.Reflect<"u"&&(r=i(e.Reflect,r)),t(r,e),typeof e.Reflect>"u"&&(e.Reflect=n);function i(h,o){return function(d,w){Object.defineProperty(h,d,{configurable:!0,writable:!0,value:w}),o&&o(d,w)}}function a(){try{return Function("return this;")()}catch{}}function u(){try{return(0,eval)("(function() { return this; })()")}catch{}}function l(){return a()||u()}})(function(t,e){var r=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",a=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",u=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",l=typeof Object.create=="function",h={__proto__:[]}instanceof Array,o=!l&&!h,d={create:l?function(){return At(Object.create(null))}:h?function(){return At({__proto__:null})}:function(){return At({})},has:o?function(s,c){return r.call(s,c)}:function(s,c){return c in s},get:o?function(s,c){return r.call(s,c)?s[c]:void 0}:function(s,c){return s[c]}},w=Object.getPrototypeOf(Function),T=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:en(),P=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:nn(),L=typeof WeakMap=="function"?WeakMap:rn(),B=i?Symbol.for("@reflect-metadata:registry"):void 0,Y=Qe(),ct=Xe(Y);function xe(s,c,f,v){if(b(f)){if(!Jt(s))throw new TypeError;if(!qt(c))throw new TypeError;return He(s,c)}else{if(!Jt(s))throw new TypeError;if(!C(c))throw new TypeError;if(!C(v)&&!b(v)&&!K(v))throw new TypeError;return K(v)&&(v=void 0),f=U(f),$e(s,c,f,v)}}t("decorate",xe);function Le(s,c){function f(v,m){if(!C(v))throw new TypeError;if(!b(m)&&!Ke(m))throw new TypeError;Vt(s,c,v,m)}return f}t("metadata",Le);function Be(s,c,f,v){if(!C(f))throw new TypeError;return b(v)||(v=U(v)),Vt(s,c,f,v)}t("defineMetadata",Be);function ke(s,c,f){if(!C(c))throw new TypeError;return b(f)||(f=U(f)),Ft(s,c,f)}t("hasMetadata",ke);function je(s,c,f){if(!C(c))throw new TypeError;return b(f)||(f=U(f)),wt(s,c,f)}t("hasOwnMetadata",je);function Fe(s,c,f){if(!C(c))throw new TypeError;return b(f)||(f=U(f)),Gt(s,c,f)}t("getMetadata",Fe);function Ge(s,c,f){if(!C(c))throw new TypeError;return b(f)||(f=U(f)),Wt(s,c,f)}t("getOwnMetadata",Ge);function We(s,c){if(!C(s))throw new TypeError;return b(c)||(c=U(c)),Ut(s,c)}t("getMetadataKeys",We);function Ve(s,c){if(!C(s))throw new TypeError;return b(c)||(c=U(c)),Ht(s,c)}t("getOwnMetadataKeys",Ve);function Ue(s,c,f){if(!C(c))throw new TypeError;if(b(f)||(f=U(f)),!C(c))throw new TypeError;b(f)||(f=U(f));var v=Q(c,f,!1);return b(v)?!1:v.OrdinaryDeleteMetadata(s,c,f)}t("deleteMetadata",Ue);function He(s,c){for(var f=s.length-1;f>=0;--f){var v=s[f],m=v(c);if(!b(m)&&!K(m)){if(!qt(m))throw new TypeError;c=m}}return c}function $e(s,c,f,v){for(var m=s.length-1;m>=0;--m){var D=s[m],M=D(c,f,v);if(!b(M)&&!K(M)){if(!C(M))throw new TypeError;v=M}}return v}function Ft(s,c,f){var v=wt(s,c,f);if(v)return!0;var m=St(c);return K(m)?!1:Ft(s,m,f)}function wt(s,c,f){var v=Q(c,f,!1);return b(v)?!1:Yt(v.OrdinaryHasOwnMetadata(s,c,f))}function Gt(s,c,f){var v=wt(s,c,f);if(v)return Wt(s,c,f);var m=St(c);if(!K(m))return Gt(s,m,f)}function Wt(s,c,f){var v=Q(c,f,!1);if(!b(v))return v.OrdinaryGetOwnMetadata(s,c,f)}function Vt(s,c,f,v){var m=Q(f,v,!0);m.OrdinaryDefineOwnMetadata(s,c,f,v)}function Ut(s,c){var f=Ht(s,c),v=St(s);if(v===null)return f;var m=Ut(v,c);if(m.length<=0)return f;if(f.length<=0)return m;for(var D=new P,M=[],S=0,g=f;S<g.length;S++){var p=g[S],y=D.has(p);y||(D.add(p),M.push(p))}for(var _=0,A=m;_<A.length;_++){var p=A[_],y=D.has(p);y||(D.add(p),M.push(p))}return M}function Ht(s,c){var f=Q(s,c,!1);return f?f.OrdinaryOwnMetadataKeys(s,c):[]}function $t(s){if(s===null)return 1;switch(typeof s){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return s===null?1:6;default:return 6}}function b(s){return s===void 0}function K(s){return s===null}function Ye(s){return typeof s=="symbol"}function C(s){return typeof s=="object"?s!==null:typeof s=="function"}function Je(s,c){switch($t(s)){case 0:return s;case 1:return s;case 2:return s;case 3:return s;case 4:return s;case 5:return s}var f="string",v=zt(s,a);if(v!==void 0){var m=v.call(s,f);if(C(m))throw new TypeError;return m}return qe(s)}function qe(s,c){var f,v;{var m=s.toString;if(ft(m)){var v=m.call(s);if(!C(v))return v}var f=s.valueOf;if(ft(f)){var v=f.call(s);if(!C(v))return v}}throw new TypeError}function Yt(s){return!!s}function ze(s){return""+s}function U(s){var c=Je(s);return Ye(c)?c:ze(c)}function Jt(s){return Array.isArray?Array.isArray(s):s instanceof Object?s instanceof Array:Object.prototype.toString.call(s)==="[object Array]"}function ft(s){return typeof s=="function"}function qt(s){return typeof s=="function"}function Ke(s){switch($t(s)){case 3:return!0;case 4:return!0;default:return!1}}function bt(s,c){return s===c||s!==s&&c!==c}function zt(s,c){var f=s[c];if(f!=null){if(!ft(f))throw new TypeError;return f}}function Kt(s){var c=zt(s,u);if(!ft(c))throw new TypeError;var f=c.call(s);if(!C(f))throw new TypeError;return f}function Zt(s){return s.value}function Qt(s){var c=s.next();return c.done?!1:c}function Xt(s){var c=s.return;c&&c.call(s)}function St(s){var c=Object.getPrototypeOf(s);if(typeof s!="function"||s===w||c!==w)return c;var f=s.prototype,v=f&&Object.getPrototypeOf(f);if(v==null||v===Object.prototype)return c;var m=v.constructor;return typeof m!="function"||m===s?c:m}function Ze(){var s;!b(B)&&typeof e.Reflect<"u"&&!(B in e.Reflect)&&typeof e.Reflect.defineMetadata=="function"&&(s=tn(e.Reflect));var c,f,v,m=new L,D={registerProvider:M,getProvider:g,setProvider:y};return D;function M(_){if(!Object.isExtensible(D))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case s===_:break;case b(c):c=_;break;case c===_:break;case b(f):f=_;break;case f===_:break;default:v===void 0&&(v=new P),v.add(_);break}}function S(_,A){if(!b(c)){if(c.isProviderFor(_,A))return c;if(!b(f)){if(f.isProviderFor(_,A))return c;if(!b(v))for(var I=Kt(v);;){var O=Qt(I);if(!O)return;var W=Zt(O);if(W.isProviderFor(_,A))return Xt(I),W}}}if(!b(s)&&s.isProviderFor(_,A))return s}function g(_,A){var I=m.get(_),O;return b(I)||(O=I.get(A)),b(O)&&(O=S(_,A),b(O)||(b(I)&&(I=new T,m.set(_,I)),I.set(A,O))),O}function p(_){if(b(_))throw new TypeError;return c===_||f===_||!b(v)&&v.has(_)}function y(_,A,I){if(!p(I))throw new Error("Metadata provider not registered.");var O=g(_,A);if(O!==I){if(!b(O))return!1;var W=m.get(_);b(W)&&(W=new T,m.set(_,W)),W.set(A,I)}return!0}}function Qe(){var s;return!b(B)&&C(e.Reflect)&&Object.isExtensible(e.Reflect)&&(s=e.Reflect[B]),b(s)&&(s=Ze()),!b(B)&&C(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,B,{enumerable:!1,configurable:!1,writable:!1,value:s}),s}function Xe(s){var c=new L,f={isProviderFor:function(p,y){var _=c.get(p);return b(_)?!1:_.has(y)},OrdinaryDefineOwnMetadata:M,OrdinaryHasOwnMetadata:m,OrdinaryGetOwnMetadata:D,OrdinaryOwnMetadataKeys:S,OrdinaryDeleteMetadata:g};return Y.registerProvider(f),f;function v(p,y,_){var A=c.get(p),I=!1;if(b(A)){if(!_)return;A=new T,c.set(p,A),I=!0}var O=A.get(y);if(b(O)){if(!_)return;if(O=new T,A.set(y,O),!s.setProvider(p,y,f))throw A.delete(y),I&&c.delete(p),new Error("Wrong provider for target.")}return O}function m(p,y,_){var A=v(y,_,!1);return b(A)?!1:Yt(A.has(p))}function D(p,y,_){var A=v(y,_,!1);if(!b(A))return A.get(p)}function M(p,y,_,A){var I=v(_,A,!0);I.set(p,y)}function S(p,y){var _=[],A=v(p,y,!1);if(b(A))return _;for(var I=A.keys(),O=Kt(I),W=0;;){var te=Qt(O);if(!te)return _.length=W,_;var an=Zt(te);try{_[W]=an}catch(on){try{Xt(O)}finally{throw on}}W++}}function g(p,y,_){var A=v(y,_,!1);if(b(A)||!A.delete(p))return!1;if(A.size===0){var I=c.get(y);b(I)||(I.delete(_),I.size===0&&c.delete(I))}return!0}}function tn(s){var c=s.defineMetadata,f=s.hasOwnMetadata,v=s.getOwnMetadata,m=s.getOwnMetadataKeys,D=s.deleteMetadata,M=new L,S={isProviderFor:function(g,p){var y=M.get(g);return!b(y)&&y.has(p)?!0:m(g,p).length?(b(y)&&(y=new P,M.set(g,y)),y.add(p),!0):!1},OrdinaryDefineOwnMetadata:c,OrdinaryHasOwnMetadata:f,OrdinaryGetOwnMetadata:v,OrdinaryOwnMetadataKeys:m,OrdinaryDeleteMetadata:D};return S}function Q(s,c,f){var v=Y.getProvider(s,c);if(!b(v))return v;if(f){if(Y.setProvider(s,c,ct))return ct;throw new Error("Illegal state.")}}function en(){var s={},c=[],f=function(){function S(g,p,y){this._index=0,this._keys=g,this._values=p,this._selector=y}return S.prototype["@@iterator"]=function(){return this},S.prototype[u]=function(){return this},S.prototype.next=function(){var g=this._index;if(g>=0&&g<this._keys.length){var p=this._selector(this._keys[g],this._values[g]);return g+1>=this._keys.length?(this._index=-1,this._keys=c,this._values=c):this._index++,{value:p,done:!1}}return{value:void 0,done:!0}},S.prototype.throw=function(g){throw this._index>=0&&(this._index=-1,this._keys=c,this._values=c),g},S.prototype.return=function(g){return this._index>=0&&(this._index=-1,this._keys=c,this._values=c),{value:g,done:!0}},S}(),v=function(){function S(){this._keys=[],this._values=[],this._cacheKey=s,this._cacheIndex=-2}return Object.defineProperty(S.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),S.prototype.has=function(g){return this._find(g,!1)>=0},S.prototype.get=function(g){var p=this._find(g,!1);return p>=0?this._values[p]:void 0},S.prototype.set=function(g,p){var y=this._find(g,!0);return this._values[y]=p,this},S.prototype.delete=function(g){var p=this._find(g,!1);if(p>=0){for(var y=this._keys.length,_=p+1;_<y;_++)this._keys[_-1]=this._keys[_],this._values[_-1]=this._values[_];return this._keys.length--,this._values.length--,bt(g,this._cacheKey)&&(this._cacheKey=s,this._cacheIndex=-2),!0}return!1},S.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=s,this._cacheIndex=-2},S.prototype.keys=function(){return new f(this._keys,this._values,m)},S.prototype.values=function(){return new f(this._keys,this._values,D)},S.prototype.entries=function(){return new f(this._keys,this._values,M)},S.prototype["@@iterator"]=function(){return this.entries()},S.prototype[u]=function(){return this.entries()},S.prototype._find=function(g,p){if(!bt(this._cacheKey,g)){this._cacheIndex=-1;for(var y=0;y<this._keys.length;y++)if(bt(this._keys[y],g)){this._cacheIndex=y;break}}return this._cacheIndex<0&&p&&(this._cacheIndex=this._keys.length,this._keys.push(g),this._values.push(void 0)),this._cacheIndex},S}();return v;function m(S,g){return S}function D(S,g){return g}function M(S,g){return[S,g]}}function nn(){var s=function(){function c(){this._map=new T}return Object.defineProperty(c.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),c.prototype.has=function(f){return this._map.has(f)},c.prototype.add=function(f){return this._map.set(f,f),this},c.prototype.delete=function(f){return this._map.delete(f)},c.prototype.clear=function(){this._map.clear()},c.prototype.keys=function(){return this._map.keys()},c.prototype.values=function(){return this._map.keys()},c.prototype.entries=function(){return this._map.entries()},c.prototype["@@iterator"]=function(){return this.keys()},c.prototype[u]=function(){return this.keys()},c}();return s}function rn(){var s=16,c=d.create(),f=v();return function(){function g(){this._key=v()}return g.prototype.has=function(p){var y=m(p,!1);return y!==void 0?d.has(y,this._key):!1},g.prototype.get=function(p){var y=m(p,!1);return y!==void 0?d.get(y,this._key):void 0},g.prototype.set=function(p,y){var _=m(p,!0);return _[this._key]=y,this},g.prototype.delete=function(p){var y=m(p,!1);return y!==void 0?delete y[this._key]:!1},g.prototype.clear=function(){this._key=v()},g}();function v(){var g;do g="@@WeakMap@@"+S();while(d.has(c,g));return c[g]=!0,g}function m(g,p){if(!r.call(g,f)){if(!p)return;Object.defineProperty(g,f,{value:d.create()})}return g[f]}function D(g,p){for(var y=0;y<p;++y)g[y]=Math.random()*255|0;return g}function M(g){if(typeof Uint8Array=="function"){var p=new Uint8Array(g);return typeof crypto<"u"?crypto.getRandomValues(p):typeof msCrypto<"u"?msCrypto.getRandomValues(p):D(p,g),p}return D(new Array(g),g)}function S(){var g=M(s);g[6]=g[6]&79|64,g[8]=g[8]&191|128;for(var p="",y=0;y<s;++y){var _=g[y];(y===4||y===6||y===8)&&(p+="-"),_<16&&(p+="0"),p+=_.toString(16).toLowerCase()}return p}}function At(s){return s.__=void 0,delete s.__,s}})})(ne||(ne={}));var F="named",de="name",Bt="unmanaged",he="optional",yt="inject",nt="multi_inject",ve="inversify:tagged",ge="inversify:tagged_props",Nt="inversify:paramtypes",cn="design:paramtypes",re="post_construct",Ct="pre_destroy";function fn(){return[yt,nt,de,Bt,F,he]}var ie=fn(),N={Request:"Request",Singleton:"Singleton",Transient:"Transient"},E={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},at={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},ln=0;function ot(){return ln++}var dn=function(){function n(t,e){this.id=ot(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=E.Invalid,this.constraint=function(r){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return n.prototype.clone=function(){var t=new n(this.serviceIdentifier,this.scope);return t.activated=t.scope===N.Singleton?this.activated:!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},n}(),hn="Cannot apply @injectable decorator multiple times.",pe="Metadata key was used more than once in a parameter:",X="NULL argument",ae="Key Not Found",vn="Ambiguous match found for serviceIdentifier:",gn="Could not unbind serviceIdentifier:",pn="No matching bindings found for serviceIdentifier:",ye="Missing required @injectable annotation in:",yn="Missing required @inject or @multiInject annotation in:",_n=function(n){return"@inject called with undefined this could mean that the class "+n+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."},mn="Circular dependency found:",wn="Invalid binding type:",bn="No snapshot available to restore.",Sn="Invalid return type in middleware. Middleware must return!",An="Value provided to function binding must be a function!",Tn=function(n){return"You are attempting to construct '"+n+`' in a synchronous way
 but it has asynchronous dependencies.`},In="The toSelf function can only be applied when a constructor is used as service identifier",_e="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",En=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return"The number of constructor arguments in the derived class "+(n[0]+" must be >= than the number of constructor arguments of its base class.")},On="Invalid Container constructor argument. Container options must be an object.",Nn='Invalid Container option. Default scope must be a string ("singleton" or "transient").',Cn="Invalid Container option. Auto bind injectable must be a boolean",Mn="Invalid Container option. Skip base check must be a boolean",Dn="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",Rn=function(n,t){return"@postConstruct error in class "+n+": "+t},Pn=function(n,t){return"@preDestroy error in class "+n+": "+t},Mt=function(n,t){return"onDeactivation() error in class "+n+": "+t},xn=function(n,t){return"It looks like there is a circular dependency in one of the '"+n+"' bindings. Please investigate bindings with "+("service identifier '"+t+"'.")},Ln="Maximum call stack size exceeded",Bn=function(){function n(){}return n.prototype.getConstructorMetadata=function(t){var e=Reflect.getMetadata(Nt,t),r=Reflect.getMetadata(ve,t);return{compilerGeneratedMetadata:e,userGeneratedMetadata:r||{}}},n.prototype.getPropertiesMetadata=function(t){var e=Reflect.getMetadata(ge,t)||[];return e},n}(),dt={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function me(n){return n instanceof RangeError||n.message===Ln}var kn=function(n,t){try{return n()}catch(e){throw me(e)&&(e=t()),e}};function rt(n){if(typeof n=="function"){var t=n;return t.name}else{if(typeof n=="symbol")return n.toString();var t=n;return t}}function oe(n,t,e){var r="",i=e(n,t);return i.length!==0&&(r=`
Registered bindings:`,i.forEach(function(a){var u="Object";a.implementationType!==null&&(u=_t(a.implementationType)),r=r+`
 `+u,a.constraint.metaData&&(r=r+" - "+a.constraint.metaData)})),r}function we(n,t){return n.parentRequest===null?!1:n.parentRequest.serviceIdentifier===t?!0:we(n.parentRequest,t)}function jn(n){function t(r,i){i===void 0&&(i=[]);var a=rt(r.serviceIdentifier);return i.push(a),r.parentRequest!==null?t(r.parentRequest,i):i}var e=t(n);return e.reverse().join(" --> ")}function be(n){n.childRequests.forEach(function(t){if(we(t,t.serviceIdentifier)){var e=jn(t);throw new Error(mn+" "+e)}else be(t)})}function Fn(n,t){if(t.isTagged()||t.isNamed()){var e="",r=t.getNamedTag(),i=t.getCustomTags();return r!==null&&(e+=r.toString()+`
`),i!==null&&i.forEach(function(a){e+=a.toString()+`
`})," "+n+`
 `+n+" - "+e}else return" "+n}function _t(n){if(n.name)return n.name;var t=n.toString(),e=t.match(/^function\s*([^\s(]+)/);return e?e[1]:"Anonymous function: "+t}function Gn(n){return n.toString().slice(7,-1)}var Se=function(){function n(t){this.id=ot(),this.container=t}return n.prototype.addPlan=function(t){this.plan=t},n.prototype.setCurrentRequest=function(t){this.currentRequest=t},n}(),z=function(){function n(t,e){this.key=t,this.value=e}return n.prototype.toString=function(){return this.key===F?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},n}(),Wn=function(){function n(t,e){this.parentContext=t,this.rootRequest=e}return n}(),Vn=function(){function n(t){this._cb=t}return n.prototype.unwrap=function(){return this._cb()},n}(),Un=function(){function n(t){this.str=t}return n.prototype.startsWith=function(t){return this.str.indexOf(t)===0},n.prototype.endsWith=function(t){var e="",r=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},r)},n.prototype.contains=function(t){return this.str.indexOf(t)!==-1},n.prototype.equals=function(t){return this.str===t},n.prototype.value=function(){return this.str},n}(),mt=function(){function n(t,e,r,i){this.id=ot(),this.type=t,this.serviceIdentifier=r;var a=typeof e=="symbol"?Gn(e):e;this.name=new Un(a||""),this.identifier=e,this.metadata=new Array;var u=null;typeof i=="string"?u=new z(F,i):i instanceof z&&(u=i),u!==null&&this.metadata.push(u)}return n.prototype.hasTag=function(t){for(var e=0,r=this.metadata;e<r.length;e++){var i=r[e];if(i.key===t)return!0}return!1},n.prototype.isArray=function(){return this.hasTag(nt)},n.prototype.matchesArray=function(t){return this.matchesTag(nt)(t)},n.prototype.isNamed=function(){return this.hasTag(F)},n.prototype.isTagged=function(){return this.metadata.some(function(t){return ie.every(function(e){return t.key!==e})})},n.prototype.isOptional=function(){return this.matchesTag(he)(!0)},n.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(t){return t.key===F})[0]:null},n.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(t){return ie.every(function(e){return t.key!==e})}):null},n.prototype.matchesNamedTag=function(t){return this.matchesTag(F)(t)},n.prototype.matchesTag=function(t){var e=this;return function(r){for(var i=0,a=e.metadata;i<a.length;i++){var u=a[i];if(u.key===t&&u.value===r)return!0}return!1}},n}(),ht=function(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return n.concat(a||Array.prototype.slice.call(t))};function Hn(n,t){var e=_t(t);return Ae(n,e,t,!1)}function Ae(n,t,e,r){var i=n.getConstructorMetadata(e),a=i.compilerGeneratedMetadata;if(a===void 0){var u=ye+" "+t+".";throw new Error(u)}var l=i.userGeneratedMetadata,h=Object.keys(l),o=e.length===0&&h.length>0,d=h.length>e.length,w=o||d?h.length:e.length,T=Yn(r,t,a,l,w),P=Te(n,e,t),L=ht(ht([],T,!0),P,!0);return L}function $n(n,t,e,r,i){var a=i[n.toString()]||[],u=Ee(a),l=u.unmanaged!==!0,h=r[n],o=u.inject||u.multiInject;if(h=o||h,h instanceof Vn&&(h=h.unwrap()),l){var d=h===Object,w=h===Function,T=h===void 0,P=d||w||T;if(!t&&P){var L=yn+" argument "+n+" in class "+e+".";throw new Error(L)}var B=new mt(at.ConstructorArgument,u.targetName,h);return B.metadata=a,B}return null}function Yn(n,t,e,r,i){for(var a=[],u=0;u<i;u++){var l=u,h=$n(l,n,t,e,r);h!==null&&a.push(h)}return a}function Jn(n,t,e,r){var i=n||t;if(i===void 0){var a=ye+" for property "+String(e)+" in class "+r+".";throw new Error(a)}return i}function Te(n,t,e){for(var r=n.getPropertiesMetadata(t),i=[],a=Object.getOwnPropertySymbols(r),u=Object.keys(r),l=u.concat(a),h=0,o=l;h<o.length;h++){var d=o[h],w=r[d],T=Ee(w),P=T.targetName||d,L=Jn(T.inject,T.multiInject,d,e),B=new mt(at.ClassProperty,P,L);B.metadata=w,i.push(B)}var Y=Object.getPrototypeOf(t.prototype).constructor;if(Y!==Object){var ct=Te(n,Y,e);i=ht(ht([],i,!0),ct,!0)}return i}function Ie(n,t){var e=Object.getPrototypeOf(t.prototype).constructor;if(e!==Object){var r=_t(e),i=Ae(n,r,e,!0),a=i.map(function(h){return h.metadata.filter(function(o){return o.key===Bt})}),u=[].concat.apply([],a).length,l=i.length-u;return l>0?l:Ie(n,e)}else return 0}function Ee(n){var t={};return n.forEach(function(e){t[e.key.toString()]=e.value}),{inject:t[yt],multiInject:t[nt],targetName:t[de],unmanaged:t[Bt]}}var kt=function(){function n(t,e,r,i,a){this.id=ot(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=r,this.target=a,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=r===null?new Map:null}return n.prototype.addChildRequest=function(t,e,r){var i=new n(t,this.parentContext,this,e,r);return this.childRequests.push(i),i},n}();function vt(n){return n._bindingDictionary}function qn(n,t,e,r,i,a){var u=n?nt:yt,l=new z(u,e),h=new mt(t,r,e,l);if(i!==void 0){var o=new z(i,a);h.metadata.push(o)}return h}function se(n,t,e,r,i){var a=it(e.container,i.serviceIdentifier),u=[];return a.length===dt.NoBindingsAvailable&&e.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&n.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(e.container.bind(i.serviceIdentifier).toSelf(),a=it(e.container,i.serviceIdentifier)),t?u=a:u=a.filter(function(l){var h=new kt(l.serviceIdentifier,e,r,l,i);return l.constraint(h)}),zn(i.serviceIdentifier,u,i,e.container),u}function zn(n,t,e,r){switch(t.length){case dt.NoBindingsAvailable:if(e.isOptional())return t;var i=rt(n),a=pn;throw a+=Fn(i,e),a+=oe(r,i,it),new Error(a);case dt.OnlyOneBindingAvailable:return t;case dt.MultipleBindingsAvailable:default:if(e.isArray())return t;var i=rt(n),a=vn+" "+i;throw a+=oe(r,i,it),new Error(a)}}function Oe(n,t,e,r,i,a){var u,l;if(i===null){u=se(n,t,r,null,a),l=new kt(e,r,null,u,a);var h=new Wn(r,l);r.addPlan(h)}else u=se(n,t,r,i,a),l=i.addChildRequest(a.serviceIdentifier,u,a);u.forEach(function(o){var d=null;if(a.isArray())d=l.addChildRequest(o.serviceIdentifier,o,a);else{if(o.cache)return;d=l}if(o.type===E.Instance&&o.implementationType!==null){var w=Hn(n,o.implementationType);if(!r.container.options.skipBaseClassChecks){var T=Ie(n,o.implementationType);if(w.length<T){var P=En(_t(o.implementationType));throw new Error(P)}}w.forEach(function(L){Oe(n,!1,L.serviceIdentifier,r,d,L)})}})}function it(n,t){var e=[],r=vt(n);return r.hasKey(t)?e=r.get(t):n.parent!==null&&(e=it(n.parent,t)),e}function Kn(n,t,e,r,i,a,u,l){l===void 0&&(l=!1);var h=new Se(t),o=qn(e,r,i,"",a,u);try{return Oe(n,l,i,h,null,o),h}catch(d){throw me(d)&&be(h.plan.rootRequest),d}}function Zn(n,t,e,r){var i=new mt(at.Variable,"",t,new z(e,r)),a=new Se(n),u=new kt(t,a,null,[],i);return u}function x(n){var t=typeof n=="object"&&n!==null||typeof n=="function";return t&&typeof n.then=="function"}function Ne(n){return x(n)?!0:Array.isArray(n)&&n.some(x)}var Qn=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(u){u(a)})}return new(e||(e=Promise))(function(a,u){function l(d){try{o(r.next(d))}catch(w){u(w)}}function h(d){try{o(r.throw(d))}catch(w){u(w)}}function o(d){d.done?a(d.value):i(d.value).then(l,h)}o((r=r.apply(n,t||[])).next())})},Xn=function(n,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(o){return function(d){return h([o,d])}}function h(o){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(a=o[0]&2?i.return:o[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(d){o=[6,d],i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},tr=function(n,t){return t.scope===N.Singleton&&t.activated?t.cache:t.scope===N.Request&&n.has(t.id)?n.get(t.id):null},er=function(n,t,e){t.scope===N.Singleton&&rr(t,e),t.scope===N.Request&&nr(n,t,e)},nr=function(n,t,e){n.has(t.id)||n.set(t.id,e)},rr=function(n,t){n.cache=t,n.activated=!0,x(t)&&ir(n,t)},ir=function(n,t){return Qn(void 0,void 0,void 0,function(){var e,r;return Xn(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t];case 1:return e=i.sent(),n.cache=e,[3,3];case 2:throw r=i.sent(),n.cache=null,n.activated=!1,r;case 3:return[2]}})})},et;(function(n){n.DynamicValue="toDynamicValue",n.Factory="toFactory",n.Provider="toProvider"})(et||(et={}));var ar=function(n){var t=null;switch(n.type){case E.ConstantValue:case E.Function:t=n.cache;break;case E.Constructor:case E.Instance:t=n.implementationType;break;case E.DynamicValue:t=n.dynamicValue;break;case E.Provider:t=n.provider;break;case E.Factory:t=n.factory;break}if(t===null){var e=rt(n.serviceIdentifier);throw new Error(wn+" "+e)}},or=function(n){switch(n.type){case E.Factory:return{factory:n.factory,factoryType:et.Factory};case E.Provider:return{factory:n.provider,factoryType:et.Provider};case E.DynamicValue:return{factory:n.dynamicValue,factoryType:et.DynamicValue};default:throw new Error("Unexpected factory type "+n.type)}},Z=function(){return Z=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Z.apply(this,arguments)},Ce=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(u){u(a)})}return new(e||(e=Promise))(function(a,u){function l(d){try{o(r.next(d))}catch(w){u(w)}}function h(d){try{o(r.throw(d))}catch(w){u(w)}}function o(d){d.done?a(d.value):i(d.value).then(l,h)}o((r=r.apply(n,t||[])).next())})},Me=function(n,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(o){return function(d){return h([o,d])}}function h(o){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(a=o[0]&2?i.return:o[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(d){o=[6,d],i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},sr=function(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return n.concat(a||Array.prototype.slice.call(t))};function ur(n,t){return n.reduce(function(e,r){var i=t(r),a=r.target.type;return a===at.ConstructorArgument?e.constructorInjections.push(i):(e.propertyRequests.push(r),e.propertyInjections.push(i)),e.isAsync||(e.isAsync=Ne(i)),e},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function cr(n,t,e){var r;if(t.length>0){var i=ur(t,e),a=Z(Z({},i),{constr:n});i.isAsync?r=fr(a):r=De(a)}else r=new n;return r}function De(n){var t,e=new((t=n.constr).bind.apply(t,sr([void 0],n.constructorInjections,!1)));return n.propertyRequests.forEach(function(r,i){var a=r.target.identifier,u=n.propertyInjections[i];(!r.target.isOptional()||u!==void 0)&&(e[a]=u)}),e}function fr(n){return Ce(this,void 0,void 0,function(){var t,e;return Me(this,function(r){switch(r.label){case 0:return[4,ue(n.constructorInjections)];case 1:return t=r.sent(),[4,ue(n.propertyInjections)];case 2:return e=r.sent(),[2,De(Z(Z({},n),{constructorInjections:t,propertyInjections:e}))]}})})}function ue(n){return Ce(this,void 0,void 0,function(){var t,e,r,i;return Me(this,function(a){for(t=[],e=0,r=n;e<r.length;e++)i=r[e],Array.isArray(i)?t.push(Promise.all(i)):t.push(i);return[2,Promise.all(t)]})})}function ce(n,t){var e=lr(n,t);return x(e)?e.then(function(){return t}):t}function lr(n,t){var e,r;if(Reflect.hasMetadata(re,n)){var i=Reflect.getMetadata(re,n);try{return(r=(e=t)[i.value])===null||r===void 0?void 0:r.call(e)}catch(a){if(a instanceof Error)throw new Error(Rn(n.name,a.message))}}}function dr(n,t){n.scope!==N.Singleton&&hr(n,t)}function hr(n,t){var e="Class cannot be instantiated in "+(n.scope===N.Request?"request":"transient")+" scope.";if(typeof n.onDeactivation=="function")throw new Error(Mt(t.name,e));if(Reflect.hasMetadata(Ct,t))throw new Error(Pn(t.name,e))}function vr(n,t,e,r){dr(n,t);var i=cr(t,e,r);return x(i)?i.then(function(a){return ce(t,a)}):ce(t,i)}var gr=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(u){u(a)})}return new(e||(e=Promise))(function(a,u){function l(d){try{o(r.next(d))}catch(w){u(w)}}function h(d){try{o(r.throw(d))}catch(w){u(w)}}function o(d){d.done?a(d.value):i(d.value).then(l,h)}o((r=r.apply(n,t||[])).next())})},pr=function(n,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(o){return function(d){return h([o,d])}}function h(o){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(a=o[0]&2?i.return:o[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(d){o=[6,d],i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},jt=function(n){return function(t){t.parentContext.setCurrentRequest(t);var e=t.bindings,r=t.childRequests,i=t.target&&t.target.isArray(),a=!t.parentRequest||!t.parentRequest.target||!t.target||!t.parentRequest.target.matchesArray(t.target.serviceIdentifier);if(i&&a)return r.map(function(l){var h=jt(n);return h(l)});if(t.target.isOptional()&&e.length===0)return;var u=e[0];return wr(n,t,u)}},yr=function(n,t){var e=or(n);return kn(function(){return e.factory.bind(n)(t)},function(){return new Error(xn(e.factoryType,t.currentRequest.serviceIdentifier.toString()))})},_r=function(n,t,e){var r,i=t.childRequests;switch(ar(e),e.type){case E.ConstantValue:case E.Function:r=e.cache;break;case E.Constructor:r=e.implementationType;break;case E.Instance:r=vr(e,e.implementationType,i,jt(n));break;default:r=yr(e,t.parentContext)}return r},mr=function(n,t,e){var r=tr(n,t);return r!==null||(r=e(),er(n,t,r)),r},wr=function(n,t,e){return mr(n,e,function(){var r=_r(n,t,e);return x(r)?r=r.then(function(i){return fe(t,e,i)}):r=fe(t,e,r),r})};function fe(n,t,e){var r=br(n.parentContext,t,e),i=Tr(n.parentContext.container),a,u=i.next();do{a=u.value;var l=n.parentContext,h=n.serviceIdentifier,o=Ar(a,h);x(r)?r=Re(o,l,r):r=Sr(o,l,r),u=i.next()}while(u.done!==!0&&!vt(a).hasKey(n.serviceIdentifier));return r}var br=function(n,t,e){var r;return typeof t.onActivation=="function"?r=t.onActivation(n,e):r=e,r},Sr=function(n,t,e){for(var r=n.next();!r.done;){if(e=r.value(t,e),x(e))return Re(n,t,e);r=n.next()}return e},Re=function(n,t,e){return gr(void 0,void 0,void 0,function(){var r,i;return pr(this,function(a){switch(a.label){case 0:return[4,e];case 1:r=a.sent(),i=n.next(),a.label=2;case 2:return i.done?[3,4]:[4,i.value(t,r)];case 3:return r=a.sent(),i=n.next(),[3,2];case 4:return[2,r]}})})},Ar=function(n,t){var e=n._activations;return e.hasKey(t)?e.get(t).values():[].values()},Tr=function(n){for(var t=[n],e=n.parent;e!==null;)t.push(e),e=e.parent;var r=function(){var a=t.pop();return a!==void 0?{done:!1,value:a}:{done:!0,value:void 0}},i={next:r};return i};function Ir(n){var t=jt(n.plan.rootRequest.requestScope);return t(n.plan.rootRequest)}var H=function(n,t){var e=n.parentRequest;return e!==null?t(e)?!0:H(e,t):!1},tt=function(n){return function(t){var e=function(r){return r!==null&&r.target!==null&&r.target.matchesTag(n)(t)};return e.metaData=new z(n,t),e}},lt=tt(F),It=function(n){return function(t){var e=null;if(t!==null)if(e=t.bindings[0],typeof n=="string"){var r=e.serviceIdentifier;return r===n}else{var i=t.bindings[0].implementationType;return n===i}return!1}},gt=function(){function n(t){this._binding=t}return n.prototype.when=function(t){return this._binding.constraint=t,new R(this._binding)},n.prototype.whenTargetNamed=function(t){return this._binding.constraint=lt(t),new R(this._binding)},n.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){if(t===null)return!1;var e=t.target!==null&&!t.target.isNamed()&&!t.target.isTagged();return e},new R(this._binding)},n.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=tt(t)(e),new R(this._binding)},n.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return e!==null&&It(t)(e.parentRequest)},new R(this._binding)},n.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return e!==null&&lt(t)(e.parentRequest)},new R(this._binding)},n.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(r){return r!==null&&tt(t)(e)(r.parentRequest)},new R(this._binding)},n.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return e!==null&&H(e,It(t))},new R(this._binding)},n.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return e!==null&&!H(e,It(t))},new R(this._binding)},n.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return e!==null&&H(e,lt(t))},new R(this._binding)},n.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return e!==null&&!H(e,lt(t))},new R(this._binding)},n.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(r){return r!==null&&H(r,tt(t)(e))},new R(this._binding)},n.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(r){return r!==null&&!H(r,tt(t)(e))},new R(this._binding)},n.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return e!==null&&H(e,t)},new R(this._binding)},n.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return e!==null&&!H(e,t)},new R(this._binding)},n}(),R=function(){function n(t){this._binding=t}return n.prototype.onActivation=function(t){return this._binding.onActivation=t,new gt(this._binding)},n.prototype.onDeactivation=function(t){return this._binding.onDeactivation=t,new gt(this._binding)},n}(),$=function(){function n(t){this._binding=t,this._bindingWhenSyntax=new gt(this._binding),this._bindingOnSyntax=new R(this._binding)}return n.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},n.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},n.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},n.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},n.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},n.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},n.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},n.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},n.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},n.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},n.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},n.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},n.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},n.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},n.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},n.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},n.prototype.onDeactivation=function(t){return this._bindingOnSyntax.onDeactivation(t)},n}(),Er=function(){function n(t){this._binding=t}return n.prototype.inRequestScope=function(){return this._binding.scope=N.Request,new $(this._binding)},n.prototype.inSingletonScope=function(){return this._binding.scope=N.Singleton,new $(this._binding)},n.prototype.inTransientScope=function(){return this._binding.scope=N.Transient,new $(this._binding)},n}(),le=function(){function n(t){this._binding=t,this._bindingWhenSyntax=new gt(this._binding),this._bindingOnSyntax=new R(this._binding),this._bindingInSyntax=new Er(t)}return n.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},n.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},n.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},n.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},n.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},n.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},n.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},n.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},n.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},n.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},n.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},n.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},n.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},n.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},n.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},n.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},n.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},n.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},n.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},n.prototype.onDeactivation=function(t){return this._bindingOnSyntax.onDeactivation(t)},n}(),Or=function(){function n(t){this._binding=t}return n.prototype.to=function(t){return this._binding.type=E.Instance,this._binding.implementationType=t,new le(this._binding)},n.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+In);var t=this._binding.serviceIdentifier;return this.to(t)},n.prototype.toConstantValue=function(t){return this._binding.type=E.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=N.Singleton,new $(this._binding)},n.prototype.toDynamicValue=function(t){return this._binding.type=E.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new le(this._binding)},n.prototype.toConstructor=function(t){return this._binding.type=E.Constructor,this._binding.implementationType=t,this._binding.scope=N.Singleton,new $(this._binding)},n.prototype.toFactory=function(t){return this._binding.type=E.Factory,this._binding.factory=t,this._binding.scope=N.Singleton,new $(this._binding)},n.prototype.toFunction=function(t){if(typeof t!="function")throw new Error(An);var e=this.toConstantValue(t);return this._binding.type=E.Function,this._binding.scope=N.Singleton,e},n.prototype.toAutoFactory=function(t){return this._binding.type=E.Factory,this._binding.factory=function(e){var r=function(){return e.container.get(t)};return r},this._binding.scope=N.Singleton,new $(this._binding)},n.prototype.toAutoNamedFactory=function(t){return this._binding.type=E.Factory,this._binding.factory=function(e){return function(r){return e.container.getNamed(t,r)}},new $(this._binding)},n.prototype.toProvider=function(t){return this._binding.type=E.Provider,this._binding.provider=t,this._binding.scope=N.Singleton,new $(this._binding)},n.prototype.toService=function(t){this.toDynamicValue(function(e){return e.container.get(t)})},n}(),Nr=function(){function n(){}return n.of=function(t,e,r,i,a){var u=new n;return u.bindings=t,u.middleware=e,u.deactivations=i,u.activations=r,u.moduleActivationStore=a,u},n}();function Cr(n){return typeof n=="object"&&n!==null&&"clone"in n&&typeof n.clone=="function"}var J=function(){function n(){this._map=new Map}return n.prototype.getMap=function(){return this._map},n.prototype.add=function(t,e){if(t==null)throw new Error(X);if(e==null)throw new Error(X);var r=this._map.get(t);r!==void 0?r.push(e):this._map.set(t,[e])},n.prototype.get=function(t){if(t==null)throw new Error(X);var e=this._map.get(t);if(e!==void 0)return e;throw new Error(ae)},n.prototype.remove=function(t){if(t==null)throw new Error(X);if(!this._map.delete(t))throw new Error(ae)},n.prototype.removeIntersection=function(t){var e=this;this.traverse(function(r,i){var a=t.hasKey(r)?t.get(r):void 0;if(a!==void 0){var u=i.filter(function(l){return!a.some(function(h){return l===h})});e._setValue(r,u)}})},n.prototype.removeByCondition=function(t){var e=this,r=[];return this._map.forEach(function(i,a){for(var u=[],l=0,h=i;l<h.length;l++){var o=h[l],d=t(o);d?r.push(o):u.push(o)}e._setValue(a,u)}),r},n.prototype.hasKey=function(t){if(t==null)throw new Error(X);return this._map.has(t)},n.prototype.clone=function(){var t=new n;return this._map.forEach(function(e,r){e.forEach(function(i){return t.add(r,Cr(i)?i.clone():i)})}),t},n.prototype.traverse=function(t){this._map.forEach(function(e,r){t(r,e)})},n.prototype._setValue=function(t,e){e.length>0?this._map.set(t,e):this._map.delete(t)},n}(),Mr=function(){function n(){this._map=new Map}return n.prototype.remove=function(t){if(this._map.has(t)){var e=this._map.get(t);return this._map.delete(t),e}return this._getEmptyHandlersStore()},n.prototype.addDeactivation=function(t,e,r){this._getModuleActivationHandlers(t).onDeactivations.add(e,r)},n.prototype.addActivation=function(t,e,r){this._getModuleActivationHandlers(t).onActivations.add(e,r)},n.prototype.clone=function(){var t=new n;return this._map.forEach(function(e,r){t._map.set(r,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})}),t},n.prototype._getModuleActivationHandlers=function(t){var e=this._map.get(t);return e===void 0&&(e=this._getEmptyHandlersStore(),this._map.set(t,e)),e},n.prototype._getEmptyHandlersStore=function(){var t={onActivations:new J,onDeactivations:new J};return t},n}(),pt=function(){return pt=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},pt.apply(this,arguments)},k=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(u){u(a)})}return new(e||(e=Promise))(function(a,u){function l(d){try{o(r.next(d))}catch(w){u(w)}}function h(d){try{o(r.throw(d))}catch(w){u(w)}}function o(d){d.done?a(d.value):i(d.value).then(l,h)}o((r=r.apply(n,t||[])).next())})},j=function(n,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(o){return function(d){return h([o,d])}}function h(o){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(a=o[0]&2?i.return:o[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(d){o=[6,d],i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Dr=function(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return n.concat(a||Array.prototype.slice.call(t))},Rr=function(){function n(t){var e=t||{};if(typeof e!="object")throw new Error(""+On);if(e.defaultScope===void 0)e.defaultScope=N.Transient;else if(e.defaultScope!==N.Singleton&&e.defaultScope!==N.Transient&&e.defaultScope!==N.Request)throw new Error(""+Nn);if(e.autoBindInjectable===void 0)e.autoBindInjectable=!1;else if(typeof e.autoBindInjectable!="boolean")throw new Error(""+Cn);if(e.skipBaseClassChecks===void 0)e.skipBaseClassChecks=!1;else if(typeof e.skipBaseClassChecks!="boolean")throw new Error(""+Mn);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=ot(),this._bindingDictionary=new J,this._snapshots=[],this._middleware=null,this._activations=new J,this._deactivations=new J,this.parent=null,this._metadataReader=new Bn,this._moduleActivationStore=new Mr}return n.merge=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=new n,u=Dr([t,e],r,!0).map(function(o){return vt(o)}),l=vt(a);function h(o,d){o.traverse(function(w,T){T.forEach(function(P){d.add(P.serviceIdentifier,P.clone())})})}return u.forEach(function(o){h(o,l)}),a},n.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this._getContainerModuleHelpersFactory(),i=0,a=t;i<a.length;i++){var u=a[i],l=r(u.id);u.registry(l.bindFunction,l.unbindFunction,l.isboundFunction,l.rebindFunction,l.unbindAsyncFunction,l.onActivationFunction,l.onDeactivationFunction)}},n.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return k(this,void 0,void 0,function(){var r,i,a,u,l;return j(this,function(h){switch(h.label){case 0:r=this._getContainerModuleHelpersFactory(),i=0,a=t,h.label=1;case 1:return i<a.length?(u=a[i],l=r(u.id),[4,u.registry(l.bindFunction,l.unbindFunction,l.isboundFunction,l.rebindFunction,l.unbindAsyncFunction,l.onActivationFunction,l.onDeactivationFunction)]):[3,4];case 2:h.sent(),h.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},n.prototype.unload=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.forEach(function(i){var a=t._removeModuleBindings(i.id);t._deactivateSingletons(a),t._removeModuleHandlers(i.id)})},n.prototype.unloadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return k(this,void 0,void 0,function(){var r,i,a,u;return j(this,function(l){switch(l.label){case 0:r=0,i=t,l.label=1;case 1:return r<i.length?(a=i[r],u=this._removeModuleBindings(a.id),[4,this._deactivateSingletonsAsync(u)]):[3,4];case 2:l.sent(),this._removeModuleHandlers(a.id),l.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},n.prototype.bind=function(t){var e=this.options.defaultScope||N.Transient,r=new dn(t,e);return this._bindingDictionary.add(t,r),new Or(r)},n.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},n.prototype.rebindAsync=function(t){return k(this,void 0,void 0,function(){return j(this,function(e){switch(e.label){case 0:return[4,this.unbindAsync(t)];case 1:return e.sent(),[2,this.bind(t)]}})})},n.prototype.unbind=function(t){if(this._bindingDictionary.hasKey(t)){var e=this._bindingDictionary.get(t);this._deactivateSingletons(e)}this._removeServiceFromDictionary(t)},n.prototype.unbindAsync=function(t){return k(this,void 0,void 0,function(){var e;return j(this,function(r){switch(r.label){case 0:return this._bindingDictionary.hasKey(t)?(e=this._bindingDictionary.get(t),[4,this._deactivateSingletonsAsync(e)]):[3,2];case 1:r.sent(),r.label=2;case 2:return this._removeServiceFromDictionary(t),[2]}})})},n.prototype.unbindAll=function(){var t=this;this._bindingDictionary.traverse(function(e,r){t._deactivateSingletons(r)}),this._bindingDictionary=new J},n.prototype.unbindAllAsync=function(){return k(this,void 0,void 0,function(){var t,e=this;return j(this,function(r){switch(r.label){case 0:return t=[],this._bindingDictionary.traverse(function(i,a){t.push(e._deactivateSingletonsAsync(a))}),[4,Promise.all(t)];case 1:return r.sent(),this._bindingDictionary=new J,[2]}})})},n.prototype.onActivation=function(t,e){this._activations.add(t,e)},n.prototype.onDeactivation=function(t,e){this._deactivations.add(t,e)},n.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},n.prototype.isCurrentBound=function(t){return this._bindingDictionary.hasKey(t)},n.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,F,e)},n.prototype.isBoundTagged=function(t,e,r){var i=!1;if(this._bindingDictionary.hasKey(t)){var a=this._bindingDictionary.get(t),u=Zn(this,t,e,r);i=a.some(function(l){return l.constraint(u)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(t,e,r)),i},n.prototype.snapshot=function(){this._snapshots.push(Nr.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},n.prototype.restore=function(){var t=this._snapshots.pop();if(t===void 0)throw new Error(bn);this._bindingDictionary=t.bindings,this._activations=t.activations,this._deactivations=t.deactivations,this._middleware=t.middleware,this._moduleActivationStore=t.moduleActivationStore},n.prototype.createChild=function(t){var e=new n(t||this.options);return e.parent=this,e},n.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce(function(i,a){return a(i)},r)},n.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},n.prototype.get=function(t){var e=this._getNotAllArgs(t,!1);return this._getButThrowIfAsync(e)},n.prototype.getAsync=function(t){return k(this,void 0,void 0,function(){var e;return j(this,function(r){return e=this._getNotAllArgs(t,!1),[2,this._get(e)]})})},n.prototype.getTagged=function(t,e,r){var i=this._getNotAllArgs(t,!1,e,r);return this._getButThrowIfAsync(i)},n.prototype.getTaggedAsync=function(t,e,r){return k(this,void 0,void 0,function(){var i;return j(this,function(a){return i=this._getNotAllArgs(t,!1,e,r),[2,this._get(i)]})})},n.prototype.getNamed=function(t,e){return this.getTagged(t,F,e)},n.prototype.getNamedAsync=function(t,e){return this.getTaggedAsync(t,F,e)},n.prototype.getAll=function(t){var e=this._getAllArgs(t);return this._getButThrowIfAsync(e)},n.prototype.getAllAsync=function(t){var e=this._getAllArgs(t);return this._getAll(e)},n.prototype.getAllTagged=function(t,e,r){var i=this._getNotAllArgs(t,!0,e,r);return this._getButThrowIfAsync(i)},n.prototype.getAllTaggedAsync=function(t,e,r){var i=this._getNotAllArgs(t,!0,e,r);return this._getAll(i)},n.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,F,e)},n.prototype.getAllNamedAsync=function(t,e){return this.getAllTaggedAsync(t,F,e)},n.prototype.resolve=function(t){var e=this.isBound(t);e||this.bind(t).toSelf();var r=this.get(t);return e||this.unbind(t),r},n.prototype._preDestroy=function(t,e){var r,i;if(Reflect.hasMetadata(Ct,t)){var a=Reflect.getMetadata(Ct,t);return(i=(r=e)[a.value])===null||i===void 0?void 0:i.call(r)}},n.prototype._removeModuleHandlers=function(t){var e=this._moduleActivationStore.remove(t);this._activations.removeIntersection(e.onActivations),this._deactivations.removeIntersection(e.onDeactivations)},n.prototype._removeModuleBindings=function(t){return this._bindingDictionary.removeByCondition(function(e){return e.moduleId===t})},n.prototype._deactivate=function(t,e){var r=this,i=Object.getPrototypeOf(e).constructor;try{if(this._deactivations.hasKey(t.serviceIdentifier)){var a=this._deactivateContainer(e,this._deactivations.get(t.serviceIdentifier).values());if(x(a))return this._handleDeactivationError(a.then(function(){return r._propagateContainerDeactivationThenBindingAndPreDestroyAsync(t,e,i)}),i)}var u=this._propagateContainerDeactivationThenBindingAndPreDestroy(t,e,i);if(x(u))return this._handleDeactivationError(u,i)}catch(l){if(l instanceof Error)throw new Error(Mt(i.name,l.message))}},n.prototype._handleDeactivationError=function(t,e){return k(this,void 0,void 0,function(){var r;return j(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t];case 1:return i.sent(),[3,3];case 2:if(r=i.sent(),r instanceof Error)throw new Error(Mt(e.name,r.message));return[3,3];case 3:return[2]}})})},n.prototype._deactivateContainer=function(t,e){for(var r=this,i=e.next();i.value;){var a=i.value(t);if(x(a))return a.then(function(){return r._deactivateContainerAsync(t,e)});i=e.next()}},n.prototype._deactivateContainerAsync=function(t,e){return k(this,void 0,void 0,function(){var r;return j(this,function(i){switch(i.label){case 0:r=e.next(),i.label=1;case 1:return r.value?[4,r.value(t)]:[3,3];case 2:return i.sent(),r=e.next(),[3,1];case 3:return[2]}})})},n.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(d,w){d._binding.moduleId=w},r=function(d){return function(w){var T=t.bind(w);return e(T,d),T}},i=function(){return function(d){return t.unbind(d)}},a=function(){return function(d){return t.unbindAsync(d)}},u=function(){return function(d){return t.isBound(d)}},l=function(d){return function(w){var T=t.rebind(w);return e(T,d),T}},h=function(d){return function(w,T){t._moduleActivationStore.addActivation(d,w,T),t.onActivation(w,T)}},o=function(d){return function(w,T){t._moduleActivationStore.addDeactivation(d,w,T),t.onDeactivation(w,T)}};return function(d){return{bindFunction:r(d),isboundFunction:u(),onActivationFunction:h(d),onDeactivationFunction:o(d),rebindFunction:l(d),unbindFunction:i(),unbindAsyncFunction:a()}}},n.prototype._getAll=function(t){return Promise.all(this._get(t))},n.prototype._get=function(t){var e=pt(pt({},t),{contextInterceptor:function(i){return i},targetType:at.Variable});if(this._middleware){var r=this._middleware(e);if(r==null)throw new Error(Sn);return r}return this._planAndResolve()(e)},n.prototype._getButThrowIfAsync=function(t){var e=this._get(t);if(Ne(e))throw new Error(Tn(t.serviceIdentifier));return e},n.prototype._getAllArgs=function(t){var e={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t};return e},n.prototype._getNotAllArgs=function(t,e,r,i){var a={avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:r,value:i};return a},n.prototype._planAndResolve=function(){var t=this;return function(e){var r=Kn(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);r=e.contextInterceptor(r);var i=Ir(r);return i}},n.prototype._deactivateIfSingleton=function(t){var e=this;if(t.activated)return x(t.cache)?t.cache.then(function(r){return e._deactivate(t,r)}):this._deactivate(t,t.cache)},n.prototype._deactivateSingletons=function(t){for(var e=0,r=t;e<r.length;e++){var i=r[e],a=this._deactivateIfSingleton(i);if(x(a))throw new Error(Dn)}},n.prototype._deactivateSingletonsAsync=function(t){return k(this,void 0,void 0,function(){var e=this;return j(this,function(r){switch(r.label){case 0:return[4,Promise.all(t.map(function(i){return e._deactivateIfSingleton(i)}))];case 1:return r.sent(),[2]}})})},n.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(t,e,r){return this.parent?this._deactivate.bind(this.parent)(t,e):this._bindingDeactivationAndPreDestroy(t,e,r)},n.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(t,e,r){return k(this,void 0,void 0,function(){return j(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(t,e)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(t,e,r)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},n.prototype._removeServiceFromDictionary=function(t){try{this._bindingDictionary.remove(t)}catch{throw new Error(gn+" "+rt(t))}},n.prototype._bindingDeactivationAndPreDestroy=function(t,e,r){var i=this;if(typeof t.onDeactivation=="function"){var a=t.onDeactivation(e);if(x(a))return a.then(function(){return i._preDestroy(r,e)})}return this._preDestroy(r,e)},n.prototype._bindingDeactivationAndPreDestroyAsync=function(t,e,r){return k(this,void 0,void 0,function(){return j(this,function(i){switch(i.label){case 0:return typeof t.onDeactivation!="function"?[3,2]:[4,t.onDeactivation(e)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(r,e)];case 3:return i.sent(),[2]}})})},n}();function Pr(n){for(var t=new Set,e=0,r=n;e<r.length;e++){var i=r[e];if(t.has(i))return i;t.add(i)}}function xr(n){return n.prototype!==void 0}function Lr(n){if(n!==void 0)throw new Error(_e)}function Br(n,t,e,r){Lr(t),Pe(ve,n,e.toString(),r)}function kr(n,t,e){if(xr(n))throw new Error(_e);Pe(ge,n.constructor,t,e)}function jr(n){var t=[];if(Array.isArray(n)){t=n;var e=Pr(t.map(function(r){return r.key}));if(e!==void 0)throw new Error(pe+" "+e.toString())}else t=[n];return t}function Pe(n,t,e,r){var i=jr(r),a={};Reflect.hasOwnMetadata(n,t)&&(a=Reflect.getMetadata(n,t));var u=a[e];if(u===void 0)u=[];else for(var l=function(w){if(i.some(function(T){return T.key===w.key}))throw new Error(pe+" "+w.key.toString())},h=0,o=u;h<o.length;h++){var d=o[h];l(d)}u.push.apply(u,i),a[e]=u,Reflect.defineMetadata(n,a,t)}function Fr(n){return function(t,e,r){typeof r=="number"?Br(t,e,r,n):kr(t,e,n)}}function st(){return function(n){if(Reflect.hasOwnMetadata(Nt,n))throw new Error(hn);var t=Reflect.getMetadata(cn,n)||[];return Reflect.defineMetadata(Nt,t,n),n}}function Gr(n){return function(t){return function(e,r,i){if(t===void 0){var a=typeof e=="function"?e.name:e.constructor.name;throw new Error(_n(a))}return Fr(new z(n,t))(e,r,i)}}}var q=Gr(yt);const G={SelectorService:Symbol.for("SelectorService"),StorageService:Symbol.for("StorageService"),PopupService:Symbol.for("PopupService"),LoggingService:Symbol.for("LoggingService"),MessageService:Symbol.for("MessageService")};class V{}Tt(V,"SELECTOR_CONSTANTS",{LISTINGS_CONSTANTS:{NAME:"div.content__884ec505 > a > div > div > div.content__97a42da1 > span",HREF:"div.content__884ec505 > a",THUMBNAIL:"a > div > div > div.merItemThumbnail.medium__a6f874a2.thumbnail__97a42da1 > figure > div.imageContainer__f8ddf3a2 > picture",CLONE_AND_DELETE_ITEM:"#clone-and-delete-item",CLONE_ITEM:"#clone-item",DELETE_ITEM:"#item-delete",NOT_PUBLIC:"div.content__97a42da1 > span.informationLabel__97a42da1",FLEA_ASSIST_BUTTON_PREVIOUS:"#currentListing > div.merList.border__17a1e07b.separator__17a1e07b > div:nth-child(",FLEA_ASSIST_BUTTON_NEXT:") > div.content__884ec505 > a > div > div >"},TODOS_CONSTANTS:{ITEM_BASE:"#main > div.merList.border__17a1e07b.separator__17a1e07b",ITEM_DETAIL:"#main > div.merList.border__17a1e07b.separator__17a1e07b > div:nth-child(3)",NAME:"div.content__884ec505 > a > div > div > div.content__8ccd0d74 > p",HREF:"div.content__884ec505 > a",THUMBNAIL:"div.content__884ec505 > a > div > div > div.merItemThumbnail.small__a6f874a2.image__8ccd0d74 > figure > div.imageContainer__f8ddf3a2"}}),Tt(V,"COMMON_CONSTANTS",{GREATER_THAN:" > "});var Wr=Object.defineProperty,Vr=Object.getOwnPropertyDescriptor,Ur=(n,t,e,r)=>{for(var i=r>1?void 0:r?Vr(t,e):t,a=n.length-1,u;a>=0;a--)(u=n[a])&&(i=(r?u(t,e,i):u(i))||i);return r&&i&&Wr(t,e,i),i},Hr=(n,t)=>(e,r)=>t(e,r,n);let Dt=class{constructor(n){this.loggingService=n}getTextContent(n,t){const e=n.querySelector(t);return e&&e.textContent||""}getThumbnail(n,t){var i;const e=n.querySelector(t);if(!e)return"./box.png";const r=(i=e.querySelector("img"))==null?void 0:i.getAttribute("src");return r||"./box.png"}getHref(n,t){const e=n.querySelector(t);return e&&e.getAttribute("href")||""}getId(n){return n.split("/").pop()||""}getItemName(n){const t=/「([^」]+)」/,e=n.match(t);if(e)return e[1].trim().replace(/\s+/g,"");throw new Error("商品名が取得できませんでした")}getRelistItemName(n){return n.trim().replace(/\s+/g,"")}isRelistItem(n){const t=[/取引メッセージがあります。返信をお願いします/,/受取りました。.*取引完了してください/,/まとめ商品/];for(const e of t)if(e.test(n))return!1;return!0}getTodosItem(n){return{id:this.getId(this.getHref(n,V.SELECTOR_CONSTANTS.TODOS_CONSTANTS.HREF)),name:this.getItemName(this.getTextContent(n,V.SELECTOR_CONSTANTS.TODOS_CONSTANTS.NAME)),thumbnail:this.getThumbnail(n,V.SELECTOR_CONSTANTS.TODOS_CONSTANTS.THUMBNAIL),url:this.getHref(n,V.SELECTOR_CONSTANTS.TODOS_CONSTANTS.HREF)}}getListingsItem(n){return{id:this.getId(this.getHref(n,V.SELECTOR_CONSTANTS.LISTINGS_CONSTANTS.HREF)),name:this.getRelistItemName(this.getTextContent(n,V.SELECTOR_CONSTANTS.LISTINGS_CONSTANTS.NAME)),thumbnail:this.getThumbnail(n,V.SELECTOR_CONSTANTS.LISTINGS_CONSTANTS.THUMBNAIL),url:this.getHref(n,V.SELECTOR_CONSTANTS.LISTINGS_CONSTANTS.HREF)}}collectItemsFromPage(n,t,e,r){this.loggingService.log("商品の取得を開始します。");let i=[],a=1,u;for(;(u=document.querySelector(`${n} > div:nth-child(${a}) > ${t}`))!==null;)try{if(u){if(r&&!r(u)){a++;continue}const l=e(u);i.push(l),a++}else break}catch(l){this.loggingService.error("商品の取得中にエラーが発生しました"),this.loggingService.error(`エラー内容 : ${l.message}`);break}return this.loggingService.log("商品の取得が完了しました。"),{itemList:i}}getAllItemsFromListings(){return this.collectItemsFromPage("#currentListing > div","div.content__884ec505",n=>this.getListingsItem(n),void 0)}getAllItemsFromTodos(){return this.collectItemsFromPage("#main > div.merList.border__17a1e07b.separator__17a1e07b","div.content__884ec505",n=>this.getTodosItem(n),n=>{const t=this.getTextContent(n,V.SELECTOR_CONSTANTS.TODOS_CONSTANTS.NAME);return this.isRelistItem(t)})}};Dt=Ur([st(),Hr(0,q(G.LoggingService))],Dt);var $r=Object.defineProperty,Yr=Object.getOwnPropertyDescriptor,Jr=(n,t,e,r)=>{for(var i=r>1?void 0:r?Yr(t,e):t,a=n.length-1,u;a>=0;a--)(u=n[a])&&(i=(r?u(t,e,i):u(i))||i);return r&&i&&$r(t,e,i),i};let Rt=class{async get(n){try{const t=localStorage.getItem(n);return t===null?null:JSON.parse(t)}catch{return null}}async set(n,t){try{localStorage.setItem(n,JSON.stringify(t))}catch{}}async pop(n){try{return localStorage.removeItem(n),!0}catch{return!1}}async setToChromeStorage(n,t){try{const e={[n]:t};await chrome.storage.local.set(e)}catch(e){console.error("データの保存中にエラーが発生しました:",e)}}async getFromChromeStorage(n){return new Promise((t,e)=>{try{chrome.storage.local.get([n],r=>{chrome.runtime.lastError?e(chrome.runtime.lastError):t(r[n]||null)})}catch(r){console.error("データの取得中にエラーが発生しました:",r),e(null)}})}};Rt=Jr([st()],Rt);var qr=Object.defineProperty,zr=Object.getOwnPropertyDescriptor,Kr=(n,t,e,r)=>{for(var i=r>1?void 0:r?zr(t,e):t,a=n.length-1,u;a>=0;a--)(u=n[a])&&(i=(r?u(t,e,i):u(i))||i);return r&&i&&qr(t,e,i),i},Et=(n,t)=>(e,r)=>t(e,r,n);let Pt=class{constructor(n,t,e){this.loggingService=n,this.messageService=t,this.storageService=e}getItemListButtonClick(){document.addEventListener("DOMContentLoaded",async()=>{try{const n=document.getElementById("item-info");if(!n)throw new Error("ボタンがありませんでした");n.addEventListener("click",async()=>{this.loggingService.log("ボタン押下時の処理を開始します"),this.loggingService.log("ローカルストレージの削除を開始します"),await this.storageService.pop("itemList"),this.loggingService.log("ローカルストレージの削除を終了します"),this.loggingService.log("BackgroundへtodosItemsメッセージ送信を開始します");const t=await this.messageService.sendBackgroundMessage({action:"todosItems"});if(this.loggingService.log("BackgroundへtodosItemsメッセージ送信を終了します"),this.loggingService.log("ボタン押下時の処理を終了します。"),!t.success){alert("エラーが発生しました。");return}})}catch(n){this.loggingService.error(`ボタン押下時のエラー: ${n.message}`),alert("エラーが発生しました。")}})}getListingItemsButtonClick(){document.addEventListener("DOMContentLoaded",async()=>{try{const n=document.getElementById("relist-item");if(!n)throw new Error("ボタンがありませんでした");n.addEventListener("click",async()=>{this.loggingService.log("ボタン押下時の処理を開始します"),this.loggingService.log("BackgroundへgetListingItemsメッセージ送信を開始します");const t=await this.messageService.sendBackgroundMessage({action:"getListingItems"});if(this.loggingService.log("BackgroundへgetListingItemsメッセージ送信を終了します"),this.loggingService.log("ボタン押下時の処理を終了します。"),!t.success){alert("エラーが発生しました。");return}})}catch(n){this.loggingService.error(`ボタン押下時のエラー: ${n.message}`),alert("エラーが発生しました。")}})}};Pt=Kr([st(),Et(0,q(G.LoggingService)),Et(1,q(G.MessageService)),Et(2,q(G.StorageService))],Pt);var Zr=Object.defineProperty,Qr=Object.getOwnPropertyDescriptor,Xr=(n,t,e,r)=>{for(var i=r>1?void 0:r?Qr(t,e):t,a=n.length-1,u;a>=0;a--)(u=n[a])&&(i=(r?u(t,e,i):u(i))||i);return r&&i&&Zr(t,e,i),i};let xt=class{log(...n){this.printLog("INFO",this.stringifyMessages(n))}error(...n){this.printLog("ERROR",this.stringifyMessages(n))}printLog(n,t){const e=new Date().toLocaleString("ja-JP",{timeZone:"Asia/Tokyo"}),r=this.formatLog(n,e,t);console.log(r)}formatLog(n,t,e){return`${t} ${n} ${e}`}stringifyMessages(n){return n.map(t=>typeof t=="object"&&t!==null?JSON.stringify(t,null,2):String(t)).join(" ")}};xt=Xr([st()],xt);var ti=Object.defineProperty,ei=Object.getOwnPropertyDescriptor,ni=(n,t,e,r)=>{for(var i=r>1?void 0:r?ei(t,e):t,a=n.length-1,u;a>=0;a--)(u=n[a])&&(i=(r?u(t,e,i):u(i))||i);return r&&i&&ti(t,e,i),i},Ot=(n,t)=>(e,r)=>t(e,r,n);let Lt=class{constructor(n,t,e){this.loggingService=n,this.selectorService=t,this.storageService=e}handleTodosItemMessage(){chrome.runtime.onMessage.addListener(async(n,t,e)=>{if(n.action==="getTodosItems"){this.loggingService.log("商品の取得を開始します。");const r=this.selectorService.getAllItemsFromTodos();this.loggingService.log("商品リストをローカルストレージに保存します。"),this.storageService.set("itemList",r),alert("商品情報の取得が完了しました。"),e({success:!0})}return!0})}handleGetListingItemsMessage(){chrome.runtime.onMessage.addListener(async(n,t,e)=>{if(n.action==="getListingItems"){this.loggingService.log("再出品していない商品の特定を開始します。"),this.loggingService.log("再出品していない商品のリストをローカルストレージから削除します。"),await this.storageService.pop("notRelistItems");const r=await this.storageService.get("itemList");if(!r){this.loggingService.error("商品リストが取得できませんでした。"),e({success:!1});return}const i=this.selectorService.getAllItemsFromListings(),a=r.itemList.filter(u=>!i.itemList.some(l=>l.name===u.name));this.loggingService.log("再出品していない商品のリストをChrome Storageに保存します。"),this.storageService.setToChromeStorage("notRelistItems",{itemList:a}),this.loggingService.log("再出品していない商品のリストをChrome Storageに保存しました。"),alert(`再出品していない商品を特定しました。
拡張機能のオプションから確認してください。`),this.loggingService.log("再出品していない商品の特定を終了します。"),e({success:!0})}return!0})}async sendContentScriptMessage(n,t){return await this.tabsSendMessage(n,{action:t.action})}async sendBackgroundMessage(n){return await this.runtimeSendMessage({action:n.action})}async tabsSendMessage(n,t){try{this.loggingService.log(`tabにメッセージを送信します。 tabId: ${n}, message:`,t),await chrome.tabs.sendMessage(n,t)}catch(e){if(e instanceof Error)throw this.loggingService.error(`メッセージの送信に失敗しました : ${e.message}`),new Error(e.message)}}async runtimeSendMessage(n){try{return this.loggingService.log("runtimeメッセージを送信します。 message:",n),await chrome.runtime.sendMessage(n),{success:!0}}catch(t){if(t instanceof Error)throw this.loggingService.error(`メッセージの送信に失敗しました : ${t.message}`),new Error(t.message);return{success:!1}}}async getActiveTab(){return new Promise((n,t)=>{chrome.tabs.query({active:!0,currentWindow:!0},e=>{e.length===0||e[0].id===void 0?t(new Error("No active tab found.")):(this.loggingService.log(`Active tab found with ID: ${e[0].id}`),n(e[0].id))})})}};Lt=ni([st(),Ot(0,q(G.LoggingService)),Ot(1,q(G.SelectorService)),Ot(2,q(G.StorageService))],Lt);const ut=new Rr;ut.bind(G.SelectorService).to(Dt);ut.bind(G.StorageService).to(Rt);ut.bind(G.PopupService).to(Pt);ut.bind(G.LoggingService).to(xt);ut.bind(G.MessageService).to(Lt);export{G as T,ut as c};
